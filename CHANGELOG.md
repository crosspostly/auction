# Changelog

Все значимые изменения в проекте "VK Аукционный Бот" будут задокументированы в этом файле.

## [Не выпущенная версия] - 2026-02-10

### Добавлено
- **Улучшенная обработка ошибок VK API**: Реализован экспоненциальный ретрай для всех вызовов VK API с обработкой наиболее распространенных ошибок (лимиты, временные сбои)
- **Обработка событий редактирования и удаления комментариев**: Добавлены обработчики для `wall_reply_edit` и `wall_reply_delete`, с логикой обновления/удаления соответствующих ставок в системе
- **Проверка подписки на группу**: Добавлена возможность требовать подписку для участия в аукционе через настройку `require_subscription`
- **Улучшенная обработка ошибок отправки сообщений**: Добавлена проверка ошибок при отправке сообщений пользователям и обработка ситуаций, когда пользователь заблокировал сообщения от сообщества
- **Новый тип уведомлений**: Добавлен тип `subscription_required` для уведомления пользователей о необходимости подписки
- **Расширенная валидация ставок**: Интегрирована проверка подписки в процесс валидации ставок
- **Расширенные возможности мониторинга**: Добавлены события для отслеживания новых сценариев и обработки редактирования/удаления комментариев
- **Новые функции тестирования**: Добавлены модульные и интеграционные тесты для проверки полного цикла аукциона
- **Система мониторинга и автоматического восстановления**: Комплексные механизмы мониторинга, проверки здоровья системы и автоматического восстановления
- **Обновленная документация**: Обновлены README и инструкции с описанием всех новых возможностей

### Изменено
- **Версия API**: Обновлена версия VK API до 5.199 во всех вызовах
- **Улучшенное логирование**: Добавлены детализированные логи ошибок с указанием количества попыток для ретраев
- **Расширенные шаблоны сообщений**: Добавлены дружелюбные сообщения для всех сценариев, включая необходимость подписки
- **Обновлены настройки по умолчанию**: Добавлена настройка `require_subscription` со значением по умолчанию `false`

### Исправлено
- **Проблема с обработкой новых лотов**: Исправлены недостающие функции `enqueueEvent` и `processEventQueue`, которые мешали обработке новых лотов
- **Отправка уведомлений о низких ставках**: Улучшена логика отправки уведомлений пользователям, чьи ставки оказались ниже текущей
- **Обработка застрявших уведомлений**: Улучшена обработка ситуаций, когда уведомления застревают в очереди

## [1.0.0] - 2025-12-XX

### Добавлено
- **Базовая функциональность аукциона**: Автоматическое обнаружение постов-лотов, обработка ставок, определение победителей
- **Интеграция с VK API**: Callback API для получения событий, отправка сообщений и комментариев
- **Хранение данных**: Использование Google Sheets для хранения лотов, ставок, победителей и настроек
- **Симулятор аукциона**: Инструмент для тестирования и генерации тестовых данных
- **Система уведомлений**: Отправка уведомлений о перебитых ставках и победителях