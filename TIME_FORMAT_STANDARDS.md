# üìÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –≤ –ø—Ä–æ–µ–∫—Ç–µ Auction Bot

## üéØ –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

**–í—Å–µ –¥–∞—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ Moscow (GMT+3 / Europe/Moscow).**

---

## üìã –§–æ—Ä–º–∞—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö

### 1. **–õ–æ—Ç—ã (Config sheet)**

| –ö–æ–ª–æ–Ω–∫–∞ | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `created_at` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 14:30:00` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ—Ç–∞ |
| `deadline` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 21:00:00` | –î–µ–¥–ª–∞–π–Ω –∞—É–∫—Ü–∏–æ–Ω–∞ |

**–ó–∞–ø–∏—Å—å:**
```javascript
appendRow("Config", {
  created_at: new Date(),  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –≤ "dd.MM.yyyy HH:mm:ss" (MSK)
  deadline: new Date(2026, 1, 21, 21, 0, 0)  // –¢–æ–∂–µ –≤ MSK
});
```

**–ß—Ç–µ–Ω–∏–µ:**
```javascript
const deadline = parseRussianDate(row.data.deadline);  // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç Date Object –≤ MSK
```

---

### 2. **–°—Ç–∞–≤–∫–∏ (Bids sheet)**

| –ö–æ–ª–æ–Ω–∫–∞ | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `timestamp` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 16:45:30` | –í—Ä–µ–º—è —Å—Ç–∞–≤–∫–∏ (—Å–µ—Ä–≤–µ—Ä–Ω–æ–µ, MSK) |
| `vk_timestamp` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 16:45:28` | –í—Ä–µ–º—è —Å—Ç–∞–≤–∫–∏ –∏–∑ VK (–æ—Ä–∏–≥–∏–Ω–∞–ª) |

**–ó–∞–ø–∏—Å—å:**
```javascript
const vkTimestamp = comment.date ? new Date(comment.date * 1000) : new Date();
appendRow("Bids", {
  timestamp: new Date(),  // –°–µ—Ä–≤–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è (MSK)
  vk_timestamp: vkTimestamp  // –í—Ä–µ–º—è –æ—Ç VK (–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ MSK)
});
```

**–í–∞–∂–Ω–æ:** 
- `timestamp` ‚Äî –≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ –±–æ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–ª —Å—Ç–∞–≤–∫—É
- `vk_timestamp` ‚Äî –≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—Å–∞–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ VK

---

### 3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (Users sheet)**

| –ö–æ–ª–æ–Ω–∫–∞ | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `first_win_date` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 21:05:00` | –î–∞—Ç–∞ –ø–µ—Ä–≤–æ–π –ø–æ–±–µ–¥—ã |
| `last_win_date` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 21:05:00` | –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–±–µ–¥—ã |

---

### 4. **–ó–∞–∫–∞–∑—ã (Orders sheet)**

| –ö–æ–ª–æ–Ω–∫–∞ | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `win_date` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 21:05:00` | –î–∞—Ç–∞ –≤—ã–∏–≥—Ä—ã—à–∞ –ª–æ—Ç–∞ |

---

### 5. **–û—á–µ—Ä–µ–¥—å —Å–æ–±—ã—Ç–∏–π (EventQueue sheet)**

| –ö–æ–ª–æ–Ω–∫–∞ | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `receivedAt` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 16:45:30` | –í—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è –æ—Ç VK |

---

### 6. **–û—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (NotificationQueue sheet)**

| –ö–æ–ª–æ–Ω–∫–∞ | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `created_at` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 21:05:00` | –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| `processed_at` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 21:05:30` | –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| `send_after` | `dd.MM.yyyy HH:mm:ss` –∏–ª–∏ `null` | `21.02.2026 21:10:00` | –û—Ç–ª–æ–∂–∏—Ç—å –¥–æ |

---

### 7. **–í—Ö–æ–¥—è—â–∏–µ (Incoming sheet)**

| –ö–æ–ª–æ–Ω–∫–∞ | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `date` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 16:45:30` | –í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è |

---

### 8. **–ñ—É—Ä–Ω–∞–ª (Logs sheet)**

| –ö–æ–ª–æ–Ω–∫–∞ | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `date` | `dd.MM.yyyy HH:mm:ss` | `21.02.2026 16:45:30` | –í—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞ |

---

## üîß –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–æ–π

### 1. **`parseRussianDate(dateString)`** ‚Äî –ü–∞—Ä—Å–∏–Ω–≥

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `Code.gs`, —Å—Ç—Ä–æ–∫–∞ 1221

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**
```javascript
parseRussianDate("21.02.2026 21:00:00")     // –†—É—Å—Å–∫–∏–π –ø–æ–ª–Ω—ã–π
parseRussianDate("21.02.2026 21:00")        // –†—É—Å—Å–∫–∏–π –∫–æ—Ä–æ—Ç–∫–∏–π
parseRussianDate("2026-02-21T18:00:00.000Z") // ISO (UTC)
parseRussianDate(46074.75)                  // Excel serial
parseRussianDate(new Date())                // Date object
parseRussianDate(null)                      // null ‚Üí null
parseRussianDate("")                        // "" ‚Üí null
```

**–í–∞–∂–Ω–æ:** –§—É–Ω–∫—Ü–∏—è –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞—Ç—É –≤ **GMT+3 (MSK)**!

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```javascript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
const deadline = parseRussianDate(row.data.deadline);
if (deadline && deadline <= new Date()) {
  // –ê—É–∫—Ü–∏–æ–Ω –∑–∞–≤–µ—Ä—à—ë–Ω
}

// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å, –µ—Å–ª–∏ deadline null)
if (parseRussianDate(row.data.deadline) <= new Date()) {
  // ...
}
```

---

### 2. **`Utilities.formatDate(date, timeZone, format)`** ‚Äî –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è Google Apps Script

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```javascript
// –î–ª—è –≤—ã–≤–æ–¥–∞ –≤ –ª–æ–≥–∞—Ö (MSK)
const nowMSK = Utilities.formatDate(new Date(), "GMT+3", "dd.MM.yyyy HH:mm:ss");

// –î–ª—è –≤—ã–≤–æ–¥–∞ —Å —á–∞—Å–æ–≤—ã–º –ø–æ—è—Å–æ–º –ø—Ä–æ–µ–∫—Ç–∞
const nowLocal = Utilities.formatDate(new Date(), Session.getScriptTimeZone(), "dd.MM.yyyy");
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞:**
```json
{
  "timeZone": "Europe/Moscow"  // appsscript.json
}
```

---

### 3. **`new Date()`** ‚Äî –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è

**–í–∞–∂–Ω–æ:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞—Ç—É –≤ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ —Å–∫—Ä–∏–ø—Ç–∞ (**Europe/Moscow**).

```javascript
const now = new Date();  // 21.02.2026 16:45:30 GMT+0300 (MSK)
```

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞

### 1. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π –Ω–∞ null**

```javascript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
const deadline = parseRussianDate(row.data.deadline);
if (deadline && deadline <= now) {
  // –ó–∞–≤–µ—Ä—à–∞–µ–º –∞—É–∫—Ü–∏–æ–Ω
}

// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (—É–ø–∞–¥—ë—Ç, –µ—Å–ª–∏ deadline null)
if (parseRussianDate(row.data.deadline) <= now) {
  // ...
}
```

---

### 2. **–°—Ä–∞–≤–Ω–∏–≤–∞–π —Ç–æ–ª—å–∫–æ Date Object, –Ω–µ —Å—Ç—Ä–æ–∫–∏**

```javascript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
const deadline = parseRussianDate(row.data.deadline);
const now = new Date();
if (deadline <= now) { ... }

// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫)
if (row.data.deadline <= Utilities.formatDate(new Date(), "GMT+3", "dd.MM.yyyy HH:mm:ss")) {
  // ...
}
```

---

### 3. **–ù–µ —Å–º–µ—à–∏–≤–∞–π —á–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞**

```javascript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (–≤—Å—ë –≤ MSK)
const now = new Date();  // MSK
const deadline = parseRussianDate(row.data.deadline);  // MSK
if (deadline <= now) { ... }

// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Å–º–µ—à–µ–Ω–∏–µ UTC –∏ MSK)
const nowUTC = new Date().toISOString();  // UTC
const deadline = parseRussianDate(row.data.deadline);  // MSK
if (deadline <= nowUTC) { ... }  // –û–®–ò–ë–ö–ê!
```

---

### 4. **VK –ø—Ä–∏—Å—ã–ª–∞–µ—Ç Unix timestamp –≤ —Å–µ–∫—É–Ω–¥–∞—Ö**

```javascript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
const vkTimestamp = new Date(comment.date * 1000);  // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Å–µ–∫—É–Ω–¥—ã –≤ –º—Å

// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
const vkTimestamp = new Date(comment.date);  // comment.date = 1740164400 ‚Üí 1970 –≥–æ–¥!
```

---

## üìä –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ—Ç–∞:
```
–ü–æ—Å—Ç VK ‚Üí –ü–∞—Ä—Å–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞ ‚Üí new Date(year, month, day, hour, min, sec)
                              ‚Üì
                    "dd.MM.yyyy HH:mm:ss" (MSK)
                              ‚Üì
                    –¢–∞–±–ª–∏—Ü–∞ "–õ–æ—Ç—ã" (–∫–æ–ª–æ–Ω–∫–∞ deadline)
```

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∞—É–∫—Ü–∏–æ–Ω–∞:
```
–¢—Ä–∏–≥–≥–µ—Ä ‚Üí new Date() (MSK)
           ‚Üì
getSheetData("–õ–æ—Ç—ã") ‚Üí parseRussianDate(deadline) (MSK)
           ‚Üì
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ: deadline <= now
           ‚Üì
–ï—Å–ª–∏ true ‚Üí finalizeAuction()
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞–≤–∫–∏:
```
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π VK ‚Üí comment.date (Unix timestamp, —Å–µ–∫—É–Ω–¥—ã)
                    ‚Üì
          new Date(comment.date * 1000) (MSK)
                    ‚Üì
          –¢–∞–±–ª–∏—Ü–∞ "–°—Ç–∞–≤–∫–∏" (–∫–æ–ª–æ–Ω–∫–∏ timestamp, vk_timestamp)
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –î–∞—Ç–∞ –Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
```
‚ùå –û–®–ò–ë–ö–ê: parseRussianDate –≤–µ—Ä–Ω—É–ª null
```

**–ü—Ä–∏—á–∏–Ω–∞:** –í —Ç–∞–±–ª–∏—Ü–µ —Å—Ç—Ä–æ–∫–∞ –≤ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–°—É–±–±–æ—Ç–∞, 21 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≥.")

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ñ–æ—Ä–º–∞—Ç–∞ –≤ `parseRussianDate`

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ê—É–∫—Ü–∏–æ–Ω –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ

**–°–∏–º–ø—Ç–æ–º—ã:**
```
üèÅ finalizeAuction: –ó–∞–ø—É—Å–∫ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
‚úÖ –ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–æ–≤: 3
```

–ù–æ –¥–µ–¥–ª–∞–π–Ω –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—É–ø–∏–ª!

**–ü—Ä–∏—á–∏–Ω–∞:** 
1. –í —Ç–∞–±–ª–∏—Ü–µ —Å—Ç–∞—Ä–∞—è –¥–∞—Ç–∞ –≤ –Ω–µ–≤–µ—Ä–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
2. –ö—ç—à –Ω–µ —Å–±—Ä–æ—à–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –ü–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π
CacheService.getScriptCache().remove("sheet_Config");
_sheet_data_mem_cache = {};

// –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
const deadline = parseRussianDate(row.data.deadline);
const deadlineStr = deadline ? Utilities.formatDate(deadline, "GMT+3", "dd.MM.yyyy HH:mm:ss") : "NULL";
logInfo(`–õ–æ—Ç ${row.data.lot_id}: –¥–µ–¥–ª–∞–π–Ω=${deadlineStr}, —Å—ã—Ä–æ–π=${row.data.deadline}`);
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Unix timestamp –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ 1970 –≥–æ–¥

**–°–∏–º–ø—Ç–æ–º—ã:**
```
vk_timestamp: 01.01.1970 03:00:00
```

**–ü—Ä–∏—á–∏–Ω–∞:** VK –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —Å–µ–∫—É–Ω–¥—ã, –∞ –Ω–µ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
const vkTimestamp = new Date(comment.date * 1000);

// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
const vkTimestamp = new Date(comment.date);
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –≤—Ä–µ–º–µ–Ω–∏:
```javascript
runAllVerificationTests();
```

### –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã:
```javascript
test_dateParsing();              // –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–æ–≤
testAllDateFormats();            // –ö—Ä–∞—à-—Ç–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞
runFullDateCycleTest();          // –ó–∞–ø–∏—Å—å ‚Üí –ß—Ç–µ–Ω–∏–µ ‚Üí –ü–∞—Ä—Å–∏–Ω–≥
test_auctionTimeScenarios();     // –°—Ü–µ–Ω–∞—Ä–∏–∏ –∞—É–∫—Ü–∏–æ–Ω–∞ (21:00, –ø—Ä–æ–¥–ª–µ–Ω–∏–µ)
test_timeZones();                // –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞ (UTC, MSK)
test_auctionExtension();         // –ü—Ä–æ–¥–ª–µ–Ω–∏–µ (+10 –º–∏–Ω—É—Ç)
test_finalizeAuctionLogic();     // –õ–æ–≥–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
test_parseRussianDateFromSheets(); // –ü–∞—Ä—Å–∏–Ω–≥ –∏–∑ Sheets
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

### –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏ —Å –¥–∞—Ç–æ–π:

- [ ] –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ `SHEETS` (Sheets.gs)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ `applyDateFormatting` (Sheets.gs, —Å—Ç—Ä–æ–∫–∞ 197)
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `new Date()` –¥–ª—è –∑–∞–ø–∏—Å–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ MSK)
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `parseRussianDate()` –¥–ª—è —á—Ç–µ–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ null –ø–µ—Ä–µ–¥ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º

### –ü—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –¥–∞—Ç—ã –∏–∑ —Ç–µ–∫—Å—Ç–∞:

- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `parseRussianDate()` –∏–ª–∏ —Ä—É—á–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
- [ ] –£–∫–∞–∑–∞—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å GMT+3
- [ ] –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –¥–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞

### –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å VK API:

- [ ] –ü–æ–º–Ω–∏—Ç—å: `comment.date` ‚Äî Unix timestamp –≤ **—Å–µ–∫—É–Ω–¥–∞—Ö**
- [ ] –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å: `new Date(comment.date * 1000)`
- [ ] –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ `vk_timestamp` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ `finalizeAuction` (–¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
2. –ó–∞–ø—É—Å—Ç–∏ `test_parseRussianDateFromSheets()`
3. –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–µ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `dd.MM.yyyy HH:mm:ss`)

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 21.02.2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ
